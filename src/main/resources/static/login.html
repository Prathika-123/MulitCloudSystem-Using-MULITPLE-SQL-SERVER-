<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Login â€” Ultra Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
          --c1: rgb(71, 52, 114);
          --c2: rgb(83, 98, 158);
          --c3: rgb(135, 186, 195);
          --c4: rgb(214, 244, 237);

          --glass-light: rgba(255,255,255,0.18);
          --glass-dark: rgba(0,0,0,0.6);
        }

        /* BODY */
        body{
          margin:0;
          height: 100vh;
          display:flex;
          justify-content:center;
          align-items:center;
          font-family:'Poppins',sans-serif;
          background: linear-gradient(135deg, var(--c1), var(--c2), var(--c3), var(--c4));
          background-size: 300% 300%;
          animation: gradientMove 12s infinite alternate;
          overflow:hidden;
        }

        @keyframes gradientMove{
          0% {background-position:0% 50%;}
          100%{background-position:100% 50%;}
        }

        /* PARTICLE BACKGROUND */
        canvas{
          position:fixed;
          top:0;
          left:0;
          z-index:-1;
        }

        /* FLOATING ORBS */
        .orb{
          position:absolute;
          width:300px;
          height:300px;
          border-radius:50%;
          filter: blur(120px);
          animation: float 15s infinite alternate;
          z-index:-1;
        }

        .orb.one{ background:var(--c2); left:5%; top:10%; }
        .orb.two{ background:var(--c4); right:5%; bottom:10%; }
        .orb.three{ background:var(--c3); top:60%; left:40%; }

        @keyframes float{
          from{ transform:translateY(0); }
          to{ transform:translateY(-70px) translateX(40px); }
        }

        /* TOGGLE */
        .toggle-wrapper{
          position:fixed;
          top:20px;
          right:30px;
          z-index:99;
        }

        .toggle{
          width:60px;
          height:30px;
          background:#eee;
          border-radius:30px;
          position:relative;
          cursor:pointer;
        }

        .toggle-circle{
          width:26px;
          height:26px;
          background:white;
          border-radius:50%;
          position:absolute;
          top:2px;
          left:2px;
          transition:0.4s;
        }

        body.dark{
          background:linear-gradient(120deg,#04050e,#0c1126,#141b33);
        }
        body.dark .toggle{
          background:var(--c2);
        }
        body.dark .toggle-circle{
          transform:translateX(30px);
        }

        /* GLASS CARD */
        .login-container{
          width:400px;
          padding:45px;
          border-radius:28px;
          background:var(--glass-light);
          backdrop-filter: blur(25px);
          box-shadow:0 20px 70px rgba(0,0,0,0.5);
          position:relative;
          animation: levitate 5s infinite;
        }

        @keyframes levitate{
          0%,100%{ transform:translateY(0); }
          50%{ transform:translateY(-10px); }
        }

        body.dark .login-container{
          background:var(--glass-dark);
          color:white;
        }

        /* TITLE */
        h2{
          text-align:center;
          font-size:32px;
          margin-bottom:25px;
          background:linear-gradient(120deg,var(--c3),var(--c4));
          -webkit-background-clip:text;
          -webkit-text-fill-color:transparent;
        }

        /* INPUT */
        input{
          width:100%;
          padding:15px;
          border-radius:14px;
          border:none;
          margin:14px 0;
          font-size:16px;
          background:rgba(255,255,255,0.75);
        }

        input:focus{
          outline:none;
          box-shadow:0 0 0 2px var(--c3), 0 0 15px var(--c4);
          transform:scale(1.02);
        }

        body.dark input{
          background:rgba(255,255,255,0.08);
          color:white;
        }

        /* BUTTON */
        button{
          margin-top:15px;
          width:100%;
          padding:16px;
          border:none;
          border-radius:14px;
          font-size:17px;
          font-weight:600;
          color:white;
          background:linear-gradient(120deg,var(--c1),var(--c2),var(--c3));
          background-size:200%;
          cursor:pointer;
          transition:0.4s;
          position:relative;
          overflow:hidden;
        }

        button:hover{
          background-position:right;
          transform:translateY(-3px);
          box-shadow:0 0 25px var(--c3);
        }

        /* SUCCESS CIRCLE */
        .success-circle{
          position:absolute;
          width:20px;
          height:20px;
          background:var(--c4);
          border-radius:50%;
          transform:scale(0);
          animation:successWave 1.2s ease forwards;
          top:50%;
          left:50%;
          translate:-50% -50%;
          z-index:50;
        }

        @keyframes successWave{
          0%{ transform:scale(0); opacity:1;}
          70%{ transform:scale(20); opacity:0.7;}
          100%{ transform:scale(40); opacity:0;}
        }

        /* ERROR */
        .error{
          margin-top:10px;
          text-align:center;
          color:#ff4b5c;
          font-size:14px;
        }

        /* MOBILE */
        @media(max-width: 440px){
          .login-container{ width:95%; padding:28px;}
        }
    </style>
</head>

<body>

<canvas id="particleCanvas"></canvas>

<div class="orb one"></div>
<div class="orb two"></div>
<div class="orb three"></div>

<!-- Toggle -->
<div class="toggle-wrapper">
    <div class="toggle" id="toggleBtn">
        <div class="toggle-circle"></div>
    </div>
</div>

<!-- Login Card -->
<div class="login-container" id="card">
    <h2>Student Login</h2>

    <form id="loginForm">
        <input type="text" id="roll_no" placeholder="Enter Roll Number" required>
        <input type="email" id="email" placeholder="Enter Email" required>
        <button type="submit">LOGIN</button>
    </form>

    <div class="error" id="errorMessage"></div>
</div>

<script>
    /* DARK MODE */
    document.getElementById('toggleBtn').addEventListener('click',()=>{
      document.body.classList.toggle('dark');
    });

    /* PARTICLE BACKGROUND */
    const canvas=document.getElementById("particleCanvas");
    const ctx=canvas.getContext("2d");
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;

    let particles=[];
    for(let i=0;i<60;i++){
      particles.push({
        x:Math.random()*canvas.width,
        y:Math.random()*canvas.height,
        size:Math.random()*4+1,
        speedX:(Math.random()-0.5)*1.5,
        speedY:(Math.random()-0.5)*1.5
      });
    }

    function animateParticles(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      particles.forEach(p=>{
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
        ctx.fillStyle="rgba(255,255,255,0.5)";
        ctx.fill();

        p.x+=p.speedX;
        p.y+=p.speedY;

        if(p.x<0||p.x>canvas.width)p.speedX*=-1;
        if(p.y<0||p.y>canvas.height)p.speedY*=-1;
      });
      requestAnimationFrame(animateParticles);
    }
    animateParticles();

    /* LOGIN + SUCCESS ANIMATION */
    document.getElementById('loginForm').addEventListener('submit',function(e){
      e.preventDefault();

      const rollNo=document.getElementById('roll_no').value;
      const email=document.getElementById('email').value;
      document.getElementById('errorMessage').textContent="";

      fetch('http://localhost:8080/api/student/login',{
        method:"POST",
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({rollNo,email})
      })
      .then(res=>res.json())
      .then(data=>{
        if(data.success){
          let circle=document.createElement('div');
          circle.className="success-circle";
          document.getElementById("card").appendChild(circle);

          setTimeout(()=>{
            window.open('studentDetails.html?studentId='+data.studentId,'_blank');
            circle.remove();
          },1000);
        } else {
          document.getElementById('errorMessage').textContent=data.message||"Invalid credentials";
        }
      })
      .catch(()=>{
        document.getElementById('errorMessage').textContent="Server error. Try again.";
      });
    });
</script>

</body>
</html>
